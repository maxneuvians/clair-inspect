defmodule ClairInspect.Models.Vulnerability do
  import Ecto.Query
  use Ecto.Schema

  schema "vulnerability" do
    field :namespace_id, :integer
    field :name, :string
    field :description, :string
    field :link, :string
    field :severity, :string
    field :metadata, :string
    field :created_at, :utc_datetime
    field :deleted_at, :utc_datetime
  end

  def by_namespace_id(namespace_id) do
    from(t in ClairInspect.Models.Vulnerability, where: t.namespace_id == ^namespace_id)
  end
end
